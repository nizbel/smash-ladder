{% extends 'base.html' %}

{% block title %}- Desafio de Ladder {{ desafio_ladder.id  }}{% endblock %}

{% block content %}
	{% if desafio_ladder.is_cancelado %}
		<div>
			<p>
			Cancelado por {{ desafio_ladder.cancelamentodesafioladder.jogador.nick }} em 
			{{ desafio_ladder.cancelamentodesafioladder.data_hora|date:"d/m/Y H:M" }}
			</p>
		</div>
	{% else %}
		{% if not desafio_ladder.is_validado %}
		<div>
			<p>Este desafio ainda está aguardando validação</p>
			
			{% if request.user.jogador.admin %}
			<p>
				<a href="{% url 'ladder:validar_desafio_ladder' desafio_ladder.id %}">Validar agora</a>
			</p>
			{% endif %}
		</div>
		{% endif %}
	{% endif %}
	
	<div>
		<p>{{ desafio_ladder.desafiante.nick }} <strong>{{ desafio_ladder.score_desafiante }}</strong> VS 
		<strong>{{ desafio_ladder.score_desafiado }}</strong> {{ desafio_ladder.desafiado.nick }}</p>
		<p>Data/hora: <strong>{{ desafio_ladder.data_hora|date:"d/m/Y H:i" }}</strong></p>
		<p>Coringa: <strong>{{ desafio_ladder.desafio_coringa|yesno:"Sim,Não,Não" }}</strong></p>
		<p>Admin validador: 
			<strong>
			{% if desafio_ladder.admin_validador %}
				{{ desafio_ladder.admin_validador.nick }}
			{% else %}
				Não validado
			{% endif %}
			</strong>
		</p>
	</div>
	
	{% if desafio_ladder.lutas %}
	<ul>
		{% for luta in desafio_ladder.lutas %}
		<li><span>Ganhador: {{ luta.ganhador.nick }}</span> <a href="{% url 'ladder:detalhar_luta' luta.id %}">Detalhar luta</a></li>
		{% endfor %}
	</ul>
	{% endif %}
	
	{% now "Y" as current_year%} 
	{% now "n" as current_month %}
	{% if desafio_ladder.data_hora.month|stringformat:"i" != current_month or desafio_ladder.data_hora.year|stringformat:"i" != current_year %}
	<div>
		<a href="{% url 'ladder:detalhar_ladder_historico' desafio_ladder.data_hora.year desafio_ladder.data_hora.month %}">Ver Ladder</a>
	</div>
	{% else %}
		<a href="{% url 'ladder:detalhar_ladder_atual' %}">Ver Ladder</a>
	{% endif %}
{% endblock %}