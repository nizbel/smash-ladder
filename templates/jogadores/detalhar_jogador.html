{% extends 'base.html' %}
{% load static %}

{% block title %}- {{ jogador.nick }}{% endblock %}

{% block page_header %}{{ jogador.nick }}{% endblock %}

{% block extra_header %}
<link href="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.css" rel="stylesheet" />
{% endblock %}

{% block content %}
	<div class="col-12 col-md-4 my-2">
		<div class="card">
		  	<div class="card-header bg-cinza-2">
		    	Dados
		  	</div>
		  	<div class="card-body col-12">
		  		<div class="row">
			  		<div class="col-6">
					    <h6 class="card-title">Nickname</h6>
					    <h6 class="card-title">
						    <strong>{{ jogador.nick }}</strong>
					    </h6>
				    </div>
			  		<div class="col-6">
					    <h6 class="card-title">Main</h6>
					    <h6 class="card-title">
					    	{% if jogador.main %}
					    		<img class="icone-personagem mt-n1" src="{% static jogador.main.icone %}" />
					    	{% endif %}
						    <strong>{{ jogador.main|default:"Indefinido" }}</strong>
					    </h6>
				    </div>
			    
			  		<div class="col-6">
					    <h6 class="card-title">Último coringa</h6>
					    <h6 class="card-title"><strong>{{ jogador.ultimo_uso_coringa|date:"d/m/Y"|default:"Não utilizado" }}</strong></h6>
				    </div>
			  		<div class="col-6">
					    <h6 class="card-title">Admin</h6>
					    <h6 class="card-title"><strong>{{ jogador.admin|yesno:"Sim,Não,Não" }}</strong>
						</h6>
				    </div>
			    </div>
				
				{% if jogador.is_de_ferias %}
					<div class="alert alert-primary card-text d-flex justify-content-between">
						Jogador está de férias
					</div>
				{% endif %}
				
				{% if request.user.username == jogador.user.username or request.user.jogador.admin %}
				<a class="card-link" href="{% url 'jogadores:editar_jogador' jogador.user.username %}">Editar</a>
				{% endif %}
		  	</div>
		</div>
	</div>
		
	<div class="col-12 col-md-4 my-2">
		<div class="card">
		  	<div class="card-header bg-cinza-2">
		    	Desafios
		  	</div>
		  	<div class="card-body col-12">
		  		<div class="row">
			  		<div class="col-6">
					    <h6 class="card-title">Feitos</h6>
					    <h6 class="card-title">
						    <strong>{{ desafios.feitos }}</strong>
					    </h6>
				    </div>
			  		<div class="col-6">
					    <h6 class="card-title">Recebidos</h6>
					    <h6 class="card-title">
						    <strong>{{ desafios.recebidos }}</strong>
					    </h6>
				    </div>
			    
			  		<div class="col-6">
					    <h6 class="card-title">Vitórias</h6>
					    <h6 class="card-title"><strong>{{ desafios.vitorias }}</strong></h6>
				    </div>
			  		<div class="col-6">
					    <h6 class="card-title">Derrotas</h6>
					    <h6 class="card-title"><strong>{{ desafios.derrotas }}</strong>
						</h6>
				    </div>
				    
				    <div class="col-6">
					    <h6 class="card-title">% de vitórias</h6>
					    <h6 class="card-title"><strong>{{ jogador.percentual_vitorias|floatformat:"2" }}%</strong></h6>
				    </div>
			    </div>
		  	</div>
		</div>
	</div>
	
	<div class="col-12 col-md-4 my-2">
		<div class="card">
		  	<div class="card-header bg-cinza-2">
		    	Histórico para % de vitórias
		  	</div>
		  	<div class="card-body col-12">
		  		<div class="row">
		  			<div class="col-12">
						<canvas id="myChart" width="auto"></canvas>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.bundle.min.js"></script>

<script type="text/javascript">
var ctx = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'line',
    data: {
    	labels: [{% for item in jogador.grafico_percentual_vitorias %}'',{% endfor %}],
        datasets: [{
            label: '% de vitórias',
            data: {{ jogador.grafico_percentual_vitorias }},
            borderWidth: 0,
            lineTension: 0
        }]
    },
    options: {
    	legend: {
    		display: false
		},
        scales: {
            xAxes: [{
            	scaleLabel: {
	            	display: true,
	                labelString: 'Desafios'
                }
            }],
            yAxes: [{
                ticks: {
                    beginAtZero: true,
                    callback: function(value, index, values) {
                        return value + '%';
                    }
                }
            }]
        }
    }
});
</script>
{% endblock %}